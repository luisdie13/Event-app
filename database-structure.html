<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Estructura de Base de Datos - Event Platform</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px 20px;
            background: #f5f5f5;
        }
        
        .container {
            background: white;
            padding: 40px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        h1 {
            color: #2c3e50;
            border-bottom: 4px solid #3498db;
            padding-bottom: 15px;
            margin-bottom: 30px;
            font-size: 2.5em;
        }
        
        h2 {
            color: #34495e;
            margin-top: 40px;
            margin-bottom: 20px;
            font-size: 1.8em;
            border-left: 5px solid #3498db;
            padding-left: 15px;
        }
        
        h3 {
            color: #2c3e50;
            margin-top: 25px;
            margin-bottom: 15px;
            font-size: 1.3em;
            background: #ecf0f1;
            padding: 10px 15px;
            border-radius: 5px;
        }
        
        .metadata {
            background: #e8f4f8;
            padding: 20px;
            border-radius: 5px;
            margin-bottom: 30px;
            border-left: 5px solid #3498db;
        }
        
        .metadata p {
            margin: 5px 0;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        
        th {
            background: #3498db;
            color: white;
            padding: 12px;
            text-align: left;
            font-weight: 600;
        }
        
        td {
            padding: 12px;
            border-bottom: 1px solid #ecf0f1;
        }
        
        tr:hover {
            background: #f8f9fa;
        }
        
        .pk {
            color: #e74c3c;
            font-weight: bold;
        }
        
        .fk {
            color: #3498db;
            font-weight: bold;
        }
        
        .unique {
            color: #f39c12;
            font-weight: bold;
        }
        
        .diagram {
            background: white;
            padding: 30px;
            border-radius: 8px;
            margin: 30px 0;
            border: 2px solid #3498db;
        }
        
        .relationship {
            background: #fff3cd;
            padding: 15px;
            margin: 10px 0;
            border-left: 4px solid #ffc107;
            border-radius: 4px;
        }
        
        .relationship strong {
            color: #856404;
        }
        
        .feature {
            background: #d4edda;
            padding: 15px;
            margin: 10px 0;
            border-left: 4px solid #28a745;
            border-radius: 4px;
        }
        
        .note {
            background: #d1ecf1;
            padding: 15px;
            margin: 20px 0;
            border-left: 4px solid #17a2b8;
            border-radius: 4px;
        }
        
        code {
            background: #f4f4f4;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
        }
        
        .constraint-badge {
            display: inline-block;
            padding: 3px 8px;
            border-radius: 3px;
            font-size: 0.85em;
            font-weight: bold;
            margin-right: 5px;
        }
        
        .badge-pk {
            background: #fee;
            color: #c00;
        }
        
        .badge-fk {
            background: #e3f2fd;
            color: #1976d2;
        }
        
        .badge-unique {
            background: #fff3e0;
            color: #f57c00;
        }
        
        .badge-check {
            background: #f3e5f5;
            color: #7b1fa2;
        }
        
        ul {
            margin: 15px 0 15px 30px;
        }
        
        li {
            margin: 8px 0;
        }
        
        @media print {
            body {
                background: white;
            }
            .container {
                box-shadow: none;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ“Š Estructura de Base de Datos</h1>
        <h2 style="margin-top: 0;">Event Platform - Sistema de GestiÃ³n de Eventos</h2>
        
        <div class="metadata">
            <p><strong>Base de Datos:</strong> PostgreSQL 16</p>
            <p><strong>Extensiones:</strong> uuid-ossp (para generaciÃ³n de UUIDs)</p>
            <p><strong>Fecha de GeneraciÃ³n:</strong> Noviembre 2024</p>
            <p><strong>Total de Tablas:</strong> 6 (roles, users, categories, events, images, tickets)</p>
        </div>

        <h2>ğŸ”— Diagrama de Relaciones</h2>
        
        <div class="diagram">
            <pre style="font-family: monospace; line-height: 1.8; font-size: 0.9em;">
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚    roles     â”‚
    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
    â”‚ ğŸ”‘ id (PK)   â”‚
    â”‚ name         â”‚
    â”‚ created_at   â”‚
    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â”‚ 1:N
           â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚     users        â”‚
    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
    â”‚ ğŸ”‘ id (PK)       â”‚â”€â”€â”€â”€â”€â”€â”
    â”‚ ğŸ”— role_id (FK)  â”‚      â”‚
    â”‚ name             â”‚      â”‚ 1:N
    â”‚ email (UNIQUE)   â”‚      â”‚
    â”‚ password_hash    â”‚      â”‚
    â”‚ created_at       â”‚      â–¼
    â”‚ updated_at       â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚       events         â”‚
           â”‚               â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
           â”‚ 1:N           â”‚ ğŸ”‘ id (PK)           â”‚â”€â”€â”€â”€â”
           â”‚               â”‚ ğŸ”— user_id (FK)      â”‚    â”‚
           â–¼               â”‚ ğŸ”— category_id (FK)  â”‚    â”‚ 1:N
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ title                â”‚    â”‚
    â”‚     tickets      â”‚  â”‚ slug (UNIQUE)        â”‚    â”‚
    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚  â”‚ description          â”‚    â–¼
    â”‚ ğŸ”‘ id (PK)       â”‚  â”‚ date_time            â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ ğŸ”— event_id (FK) â”‚â”€â”€â”‚ location             â”‚ â”‚   images    â”‚
    â”‚ ğŸ”— user_id (FK)  â”‚  â”‚ total_tickets        â”‚ â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
    â”‚ purchase_date    â”‚  â”‚ available_tickets    â”‚ â”‚ ğŸ”‘ id (PK)  â”‚
    â”‚ quantity         â”‚  â”‚ price                â”‚ â”‚ ğŸ”— event_id â”‚
    â”‚ total_price      â”‚  â”‚ is_featured          â”‚ â”‚ url         â”‚
    â”‚ status           â”‚  â”‚ created_at           â”‚ â”‚ is_main     â”‚
    â”‚ created_at       â”‚  â”‚ updated_at           â”‚ â”‚ created_at  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â–²
                                    â”‚
                                    â”‚ N:1
                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                          â”‚    categories      â”‚
                          â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
                          â”‚ ğŸ”‘ id (PK)         â”‚
                          â”‚ name (UNIQUE)      â”‚
                          â”‚ slug (UNIQUE)      â”‚
                          â”‚ description        â”‚
                          â”‚ created_at         â”‚
                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            </pre>
        </div>

        <h2>ğŸ“‹ DescripciÃ³n de Tablas</h2>

        <h3>1. roles - Roles de Usuario</h3>
        <p><strong>PropÃ³sito:</strong> Define los diferentes roles de autorizaciÃ³n en el sistema.</p>
        <table>
            <thead>
                <tr>
                    <th>Campo</th>
                    <th>Tipo</th>
                    <th>Restricciones</th>
                    <th>DescripciÃ³n</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><span class="constraint-badge badge-pk">PK</span> id</td>
                    <td>SERIAL</td>
                    <td>PRIMARY KEY</td>
                    <td>Identificador Ãºnico del rol</td>
                </tr>
                <tr>
                    <td><span class="constraint-badge badge-unique">UNIQUE</span> name</td>
                    <td>VARCHAR(50)</td>
                    <td>NOT NULL, UNIQUE</td>
                    <td>Nombre del rol (guest, member, organizer, moderator, administrator)</td>
                </tr>
                <tr>
                    <td>created_at</td>
                    <td>TIMESTAMP</td>
                    <td>DEFAULT CURRENT_TIMESTAMP</td>
                    <td>Fecha de creaciÃ³n</td>
                </tr>
            </tbody>
        </table>
        
        <div class="feature">
            <strong>Roles Predefinidos:</strong>
            <ul>
                <li><strong>guest</strong> (ID: 1) - Usuario invitado</li>
                <li><strong>member</strong> (ID: 2) - Usuario miembro</li>
                <li><strong>organizer</strong> (ID: 3) - Organizador de eventos</li>
                <li><strong>moderator</strong> (ID: 4) - Moderador</li>
                <li><strong>administrator</strong> (ID: 5) - Administrador del sistema</li>
            </ul>
        </div>

        <h3>2. users - Usuarios del Sistema</h3>
        <p><strong>PropÃ³sito:</strong> Almacena informaciÃ³n de usuarios con autenticaciÃ³n y autorizaciÃ³n.</p>
        <table>
            <thead>
                <tr>
                    <th>Campo</th>
                    <th>Tipo</th>
                    <th>Restricciones</th>
                    <th>DescripciÃ³n</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><span class="constraint-badge badge-pk">PK</span> id</td>
                    <td>UUID</td>
                    <td>PRIMARY KEY, DEFAULT uuid_generate_v4()</td>
                    <td>Identificador Ãºnico del usuario</td>
                </tr>
                <tr>
                    <td><span class="constraint-badge badge-fk">FK</span> role_id</td>
                    <td>INTEGER</td>
                    <td>NOT NULL, REFERENCES roles(id) ON DELETE RESTRICT</td>
                    <td>Rol asignado al usuario</td>
                </tr>
                <tr>
                    <td>name</td>
                    <td>VARCHAR(100)</td>
                    <td>NOT NULL</td>
                    <td>Nombre completo del usuario</td>
                </tr>
                <tr>
                    <td><span class="constraint-badge badge-unique">UNIQUE</span> email</td>
                    <td>VARCHAR(255)</td>
                    <td>NOT NULL, UNIQUE</td>
                    <td>Correo electrÃ³nico (usado para login)</td>
                </tr>
                <tr>
                    <td>password_hash</td>
                    <td>VARCHAR(255)</td>
                    <td>NOT NULL</td>
                    <td>ContraseÃ±a hasheada con bcrypt</td>
                </tr>
                <tr>
                    <td>created_at</td>
                    <td>TIMESTAMP</td>
                    <td>DEFAULT CURRENT_TIMESTAMP</td>
                    <td>Fecha de registro</td>
                </tr>
                <tr>
                    <td>updated_at</td>
                    <td>TIMESTAMP</td>
                    <td>DEFAULT CURRENT_TIMESTAMP</td>
                    <td>Fecha de Ãºltima actualizaciÃ³n (auto-actualizado por trigger)</td>
                </tr>
            </tbody>
        </table>
        
        <div class="feature">
            <strong>Ãndices:</strong>
            <ul>
                <li><code>idx_users_email</code> - Optimiza bÃºsquedas por email</li>
            </ul>
            <strong>Triggers:</strong>
            <ul>
                <li><code>update_users_updated_at</code> - Actualiza automÃ¡ticamente updated_at en cada UPDATE</li>
            </ul>
        </div>

        <h3>3. categories - CategorÃ­as de Eventos</h3>
        <p><strong>PropÃ³sito:</strong> Organiza eventos en categorÃ­as para facilitar navegaciÃ³n y bÃºsqueda.</p>
        <table>
            <thead>
                <tr>
                    <th>Campo</th>
                    <th>Tipo</th>
                    <th>Restricciones</th>
                    <th>DescripciÃ³n</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><span class="constraint-badge badge-pk">PK</span> id</td>
                    <td>SERIAL</td>
                    <td>PRIMARY KEY</td>
                    <td>Identificador Ãºnico de la categorÃ­a</td>
                </tr>
                <tr>
                    <td><span class="constraint-badge badge-unique">UNIQUE</span> name</td>
                    <td>VARCHAR(100)</td>
                    <td>NOT NULL, UNIQUE</td>
                    <td>Nombre de la categorÃ­a</td>
                </tr>
                <tr>
                    <td><span class="constraint-badge badge-unique">UNIQUE</span> slug</td>
                    <td>VARCHAR(100)</td>
                    <td>NOT NULL, UNIQUE</td>
                    <td>Slug URL-friendly</td>
                </tr>
                <tr>
                    <td>description</td>
                    <td>TEXT</td>
                    <td>NULL</td>
                    <td>DescripciÃ³n de la categorÃ­a</td>
                </tr>
                <tr>
                    <td>created_at</td>
                    <td>TIMESTAMP</td>
                    <td>DEFAULT CURRENT_TIMESTAMP</td>
                    <td>Fecha de creaciÃ³n</td>
                </tr>
            </tbody>
        </table>
        
        <div class="feature">
            <strong>CategorÃ­as Predefinidas:</strong>
            <ul>
                <li><strong>MÃºsica</strong> - Conciertos, festivales y eventos musicales</li>
                <li><strong>Deportes</strong> - Eventos deportivos y competencias</li>
                <li><strong>TecnologÃ­a</strong> - Conferencias, hackathons y eventos tech</li>
                <li><strong>Arte</strong> - Exposiciones, galerÃ­as y eventos artÃ­sticos</li>
                <li><strong>EducaciÃ³n</strong> - Talleres, seminarios y cursos</li>
                <li><strong>Negocios</strong> - Networking, conferencias empresariales</li>
            </ul>
        </div>

        <h3>4. events - Eventos</h3>
        <p><strong>PropÃ³sito:</strong> Tabla principal que almacena la informaciÃ³n de todos los eventos.</p>
        <table>
            <thead>
                <tr>
                    <th>Campo</th>
                    <th>Tipo</th>
                    <th>Restricciones</th>
                    <th>DescripciÃ³n</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><span class="constraint-badge badge-pk">PK</span> id</td>
                    <td>UUID</td>
                    <td>PRIMARY KEY, DEFAULT uuid_generate_v4()</td>
                    <td>Identificador Ãºnico del evento</td>
                </tr>
                <tr>
                    <td><span class="constraint-badge badge-fk">FK</span> user_id</td>
                    <td>UUID</td>
                    <td>NOT NULL, REFERENCES users(id) ON DELETE CASCADE</td>
                    <td>Usuario creador del evento</td>
                </tr>
                <tr>
                    <td><span class="constraint-badge badge-fk">FK</span> category_id</td>
                    <td>INTEGER</td>
                    <td>NOT NULL, REFERENCES categories(id) ON DELETE RESTRICT</td>
                    <td>CategorÃ­a del evento</td>
                </tr>
                <tr>
                    <td>title</td>
                    <td>VARCHAR(255)</td>
                    <td>NOT NULL</td>
                    <td>TÃ­tulo del evento</td>
                </tr>
                <tr>
                    <td><span class="constraint-badge badge-unique">UNIQUE</span> slug</td>
                    <td>VARCHAR(255)</td>
                    <td>NOT NULL, UNIQUE</td>
                    <td>Slug URL-friendly</td>
                </tr>
                <tr>
                    <td>description</td>
                    <td>TEXT</td>
                    <td>NULL</td>
                    <td>DescripciÃ³n detallada del evento</td>
                </tr>
                <tr>
                    <td>date_time</td>
                    <td>TIMESTAMP</td>
                    <td>NOT NULL</td>
                    <td>Fecha y hora del evento</td>
                </tr>
                <tr>
                    <td>location</td>
                    <td>VARCHAR(255)</td>
                    <td>NOT NULL</td>
                    <td>UbicaciÃ³n del evento</td>
                </tr>
                <tr>
                    <td>total_tickets</td>
                    <td>INTEGER</td>
                    <td>NOT NULL, CHECK (total_tickets > 0)</td>
                    <td>Total de tickets disponibles</td>
                </tr>
                <tr>
                    <td>available_tickets</td>
                    <td>INTEGER</td>
                    <td>NOT NULL, CHECK (available_tickets >= 0 AND available_tickets <= total_tickets)</td>
                    <td>Tickets disponibles actualmente</td>
                </tr>
                <tr>
                    <td>price</td>
                    <td>DECIMAL(10,2)</td>
                    <td>NOT NULL, CHECK (price >= 0)</td>
                    <td>Precio por ticket</td>
                </tr>
                <tr>
                    <td>is_featured</td>
                    <td>BOOLEAN</td>
                    <td>DEFAULT FALSE</td>
                    <td>Indica si el evento es destacado</td>
                </tr>
                <tr>
                    <td>created_at</td>
                    <td>TIMESTAMP</td>
                    <td>DEFAULT CURRENT_TIMESTAMP</td>
                    <td>Fecha de creaciÃ³n</td>
                </tr>
                <tr>
                    <td>updated_at</td>
                    <td>TIMESTAMP</td>
                    <td>DEFAULT CURRENT_TIMESTAMP</td>
                    <td>Fecha de Ãºltima actualizaciÃ³n</td>
                </tr>
            </tbody>
        </table>
        
        <div class="feature">
            <strong>Ãndices:</strong>
            <ul>
                <li><code>idx_events_slug</code> - Optimiza bÃºsquedas por slug</li>
                <li><code>idx_events_category</code> - Optimiza filtros por categorÃ­a</li>
                <li><code>idx_events_date</code> - Optimiza ordenamiento por fecha</li>
                <li><code>idx_events_featured</code> - Optimiza bÃºsqueda de eventos destacados</li>
            </ul>
            <strong>Triggers:</strong>
            <ul>
                <li><code>update_events_updated_at</code> - Actualiza automÃ¡ticamente updated_at</li>
            </ul>
            <strong>Constraints:</strong>
            <ul>
                <li><code>check_available_tickets</code> - Asegura que available_tickets â‰¤ total_tickets</li>
            </ul>
        </div>

        <h3>5. images - ImÃ¡genes de Eventos</h3>
        <p><strong>PropÃ³sito:</strong> Almacena las URLs de imÃ¡genes asociadas a eventos.</p>
        <table>
            <thead>
                <tr>
                    <th>Campo</th>
                    <th>Tipo</th>
                    <th>Restricciones</th>
                    <th>DescripciÃ³n</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><span class="constraint-badge badge-pk">PK</span> id</td>
                    <td>UUID</td>
                    <td>PRIMARY KEY, DEFAULT uuid_generate_v4()</td>
                    <td>Identificador Ãºnico de la imagen</td>
                </tr>
                <tr>
                    <td><span class="constraint-badge badge-fk">FK</span> event_id</td>
                    <td>UUID</td>
                    <td>NOT NULL, REFERENCES events(id) ON DELETE CASCADE</td>
                    <td>Evento al que pertenece la imagen</td>
                </tr>
                <tr>
                    <td>url</td>
                    <td>TEXT</td>
                    <td>NOT NULL</td>
                    <td>URL de la imagen</td>
                </tr>
                <tr>
                    <td>is_main</td>
                    <td>BOOLEAN</td>
                    <td>DEFAULT FALSE</td>
                    <td>Indica si es la imagen principal del evento</td>
                </tr>
                <tr>
                    <td>created_at</td>
                    <td>TIMESTAMP</td>
                    <td>DEFAULT CURRENT_TIMESTAMP</td>
                    <td>Fecha de creaciÃ³n</td>
                </tr>
            </tbody>
        </table>
        
        <div class="feature">
            <strong>Ãndices:</strong>
            <ul>
                <li><code>idx_images_event</code> - Optimiza bÃºsquedas de imÃ¡genes por evento</li>
                <li><code>idx_images_main</code> - Optimiza bÃºsqueda de imagen principal</li>
            </ul>
        </div>

        <h3>6. tickets - Tickets/Boletos Comprados</h3>
        <p><strong>PropÃ³sito:</strong> Registra las transacciones de compra de tickets por los usuarios.</p>
        <table>
            <thead>
                <tr>
                    <th>Campo</th>
                    <th>Tipo</th>
                    <th>Restricciones</th>
                    <th>DescripciÃ³n</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><span class="constraint-badge badge-pk">PK</span> id</td>
                    <td>UUID</td>
                    <td>PRIMARY KEY, DEFAULT uuid_generate_v4()</td>
                    <td>Identificador Ãºnico del ticket</td>
                </tr>
                <tr>
                    <td><span class="constraint-badge badge-fk">FK</span> event_id</td>
                    <td>UUID</td>
                    <td>NOT NULL, REFERENCES events(id) ON DELETE CASCADE</td>
                    <td>Evento para el cual se comprÃ³ el ticket</td>
                </tr>
                <tr>
                    <td><span class="constraint-badge badge-fk">FK</span> user_id</td>
                    <td>UUID</td>
                    <td>NOT NULL, REFERENCES users(id) ON DELETE CASCADE</td>
                    <td>Usuario que comprÃ³ el ticket</td>
                </tr>
                <tr>
                    <td>purchase_date</td>
                    <td>TIMESTAMP</td>
                    <td>DEFAULT CURRENT_TIMESTAMP</td>
                    <td>Fecha de compra</td>
                </tr>
                <tr>
                    <td>quantity</td>
                    <td>INTEGER</td>
                    <td>NOT NULL, CHECK (quantity > 0)</td>
                    <td>Cantidad de tickets comprados</td>
                </tr>
                <tr>
                    <td>total_price</td>
                    <td>DECIMAL(10,2)</td>
                    <td>NOT NULL, CHECK (total_price >= 0)</td>
                    <td>Precio total de la transacciÃ³n</td>
                </tr>
                <tr>
                    <td>status</td>
                    <td>VARCHAR(50)</td>
                    <td>DEFAULT 'active', CHECK (status IN ('active', 'cancelled', 'used'))</td>
                    <td>Estado del ticket</td>
                </tr>
                <tr>
                    <td>created_at</td>
                    <td>TIMESTAMP</td>
                    <td>DEFAULT CURRENT_TIMESTAMP</td>
                    <td>Fecha de creaciÃ³n del registro</td>
                </tr>
            </tbody>
        </table>
        
        <div class="feature">
            <strong>Ãndices:</strong>
            <ul>
                <li><code>idx_tickets_event</code> - Optimiza bÃºsquedas por evento</li>
                <li><code>idx_tickets_user</code> - Optimiza bÃºsqueda de tickets por usuario</li>
                <li><code>idx_tickets_status</code> - Optimiza filtros por estado</li>
            </ul>
            <strong>Estados VÃ¡lidos:</strong>
            <ul>
                <li><strong>active</strong> - Ticket activo y vÃ¡lido</li>
                <li><strong>cancelled</strong> - Ticket cancelado</li>
                <li><strong>used</strong> - Ticket ya utilizado</li>
            </ul>
        </div>

        <h2>ğŸ” Relaciones y Claves ForÃ¡neas</h2>
        
        <div class="relationship">
            <strong>users â†’ roles</strong> (N:1)
            <p>Cada usuario tiene un rol. Un rol puede tener mÃºltiples usuarios.</p>
            <p><code>users.role_id â†’ roles.id (ON DELETE RESTRICT)</code></p>
            <p>La restricciÃ³n RESTRICT previene eliminar un rol si tiene usuarios asociados.</p>
        </div>
        
        <div class="relationship">
            <strong>events â†’ users</strong> (N:1)
            <p>Cada evento es creado por un usuario. Un usuario puede crear mÃºltiples eventos.</p>
            <p><code>events.user_id â†’ users.id (ON DELETE CASCADE)</code></p>
            <p>Si se elimina un usuario, se eliminan todos sus eventos.</p>
        </div>
        
        <div class="relationship">
            <strong>events â†’ categories</strong> (N:1)
            <p>Cada evento pertenece a una categorÃ­a. Una categorÃ­a puede tener mÃºltiples eventos.</p>
            <p><code>events.category_id â†’ categories.id (ON DELETE RESTRICT)</code></p>
            <p>No se puede eliminar una categorÃ­a si tiene eventos asociados.</p>
        </div>
        
        <div class="relationship">
            <strong>images â†’ events</strong> (N:1)
            <p>Cada imagen pertenece a un evento. Un evento puede tener mÃºltiples imÃ¡genes.</p>
            <p><code>images.event_id â†’ events.id (ON DELETE CASCADE)</code></p>
            <p>Si se elimina un evento, se eliminan todas sus imÃ¡genes.</p>
        </div>
        
        <div class="relationship">
            <strong>tickets â†’ events</strong> (N:1)
            <p>Cada ticket es para un evento especÃ­fico. Un evento puede tener mÃºltiples tickets vendidos.</p>
            <p><code>tickets.event_id â†’ events.id (ON DELETE CASCADE)</code></p>
            <p>Si se elimina un evento, se eliminan todos los tickets asociados.</p>
        </div>
        
        <div class="relationship">
            <strong>tickets â†’ users</strong> (N:1)
            <p>Cada ticket pertenece a un usuario. Un usuario puede comprar mÃºltiples tickets.</p>
            <p><code>tickets.user_id â†’ users.id (ON DELETE CASCADE)</code></p>
            <p>Si se elimina un usuario, se eliminan todos sus tickets.</p>
        </div>

        <h2>âš™ï¸ CaracterÃ­sticas TÃ©cnicas</h2>
        
        <div class="feature">
            <strong>UUIDs:</strong>
            <p>Las tablas principales (users, events, images, tickets) utilizan UUID v4 como clave primaria, lo que proporciona:</p>
            <ul>
                <li>Identificadores Ãºnicos globales</li>
                <li>Mayor seguridad (no secuenciales)</li>
                <li>Facilita merge de datos entre sistemas</li>
            </ul>
        </div>
        
        <div class="feature">
            <strong>Ãndices Optimizados:</strong>
            <p>Se han creado Ã­ndices estratÃ©gicos en:</p>
            <ul>
                <li>Campos de bÃºsqueda frecuente (email, slug)</li>
                <li>Claves forÃ¡neas para mejorar joins</li>
                <li>Campos de filtrado comÃºn (categorÃ­a, fecha, estado)</li>
                <li>Campos de ordenamiento (fecha de eventos)</li>
            </ul>
        </div>
        
        <div class="feature">
            <strong>Triggers AutomÃ¡ticos:</strong>
            <p>FunciÃ³n <code>update_updated_at_column()</code> que mantiene automÃ¡ticamente el campo updated_at en:</p>
            <ul>
                <li>Tabla users</li>
                <li>Tabla events</li>
            </ul>
        </div>
        
        <div class="feature">
            <strong>Validaciones con CHECK Constraints:</strong>
            <ul>
                <li><code>total_tickets > 0</code> - Los eventos deben tener al menos un ticket</li>
                <li><code>available_tickets >= 0</code> - No pueden haber tickets negativos</li>
                <li><code>available_tickets <= total_tickets</code> - No puede haber mÃ¡s tickets disponibles que el total</li>
                <li><code>price >= 0</code> - El precio no puede ser negativo</li>
                <li><code>quantity > 0</code> - Debe comprarse al menos un ticket</li>
                <li><code>status IN ('active', 'cancelled', 'used')</code> - Solo estados vÃ¡lidos</li>
            </ul>
        </div>

        <h2>ğŸ’¡ DiseÃ±o de Integridad Referencial</h2>
        
        <div class="note">
            <h4>Estrategia de DELETE:</h4>
            <ul>
                <li><strong>CASCADE:</strong> Se usa cuando los registros hijos deben eliminarse automÃ¡ticamente al eliminar el padre (eventsâ†’users, imagesâ†’events, ticketsâ†’events, ticketsâ†’users)</li>
                <li><strong>RESTRICT:</strong> Se usa cuando queremos prevenir la eliminaciÃ³n si hay registros dependientes (usersâ†’roles, eventsâ†’categories)</li>
            </ul>
        </div>

        <h2>ğŸ“Š Resumen de OrganizaciÃ³n</h2>
        
        <div class="feature">
            <h4>CategorizaciÃ³n Clara:</h4>
            <p>El sistema categoriza eventos en 6 categorÃ­as principales: MÃºsica, Deportes, TecnologÃ­a, Arte, EducaciÃ³n y Negocios. Cada evento debe pertenecer a exactamente una categorÃ­a.</p>
        </div>
        
        <div class="feature">
            <h4>Control de Transacciones:</h4>
            <p>La tabla <strong>tickets</strong> funciona como registro de transacciones, almacenando:</p>
            <ul>
                <li>QuiÃ©n comprÃ³ (user_id)</li>
                <li>QuÃ© comprÃ³ (event_id)</li>
                <li>CuÃ¡ndo comprÃ³ (purchase_date)</li>
                <li>CuÃ¡nto comprÃ³ (quantity, total_price)</li>
                <li>Estado actual (status: active/cancelled/used)</li>
            </ul>
        </div>
        
        <div class="feature">
            <h4>Sistema de Roles:</h4>
            <p>Implementa autorizaciÃ³n basada en roles con 5 niveles:</p>
            <ul>
                <li><strong>Guest:</strong> Usuarios no registrados (nivel mÃ¡s bajo)</li>
                <li><strong>Member:</strong> Usuarios registrados que pueden comprar tickets</li>
                <li><strong>Organizer:</strong> Pueden crear y gestionar eventos</li>
                <li><strong>Moderator:</strong> SupervisiÃ³n de contenido</li>
                <li><strong>Administrator:</strong> Control total del sistema (nivel mÃ¡s alto)</li>
            </ul>
        </div>

        <h2>ğŸ¯ Casos de Uso Principales</h2>
        
        <div class="relationship">
            <strong>1. Registro de Usuario:</strong>
            <p>Se crea un registro en <code>users</code> con role_id = 2 (member) por defecto.</p>
        </div>
        
        <div class="relationship">
            <strong>2. CreaciÃ³n de Evento:</strong>
            <p>Un usuario (organizador o admin) crea un evento que se vincula a una categorÃ­a y al usuario creador.</p>
        </div>
        
        <div class="relationship">
            <strong>3. Compra de Tickets:</strong>
            <p>Se crea un registro en <code>tickets</code> vinculando usuario y evento, y se decrementa <code>available_tickets</code> en <code>events</code>.</p>
        </div>
        
        <div class="relationship">
            <strong>4. GestiÃ³n de ImÃ¡genes:</strong>
            <p>Cada evento puede tener mÃºltiples imÃ¡genes, donde una se marca como principal con <code>is_main = true</code>.</p>
        </div>

        <div class="note">
            <h4>ğŸ“Œ Notas Importantes:</h4>
            <ul>
                <li>Las contraseÃ±as se almacenan hasheadas con bcrypt (nunca en texto plano)</li>
                <li>Los UUIDs proporcionan identificadores Ãºnicos globales y mÃ¡s seguros</li>
                <li>Los Ã­ndices mejoran significativamente el rendimiento de consultas comunes</li>
                <li>Los constraints garantizan la integridad de los datos a nivel de base de datos</li>
                <li>Los triggers mantienen automÃ¡ticamente los timestamps de actualizaciÃ³n</li>
            </ul>
        </div>

        <hr style="margin: 40px 0; border: none; border-top: 2px solid #ecf0f1;">
        
        <div style="text-align: center; color: #7f8c8d; font-size: 0.9em; padding: 20px 0;">
            <p><strong>Event Platform</strong> - Sistema de GestiÃ³n de Eventos</p>
            <p>Estructura de Base de Datos PostgreSQL 16</p>
            <p>Generado: Noviembre 2024</p>
        </div>
    </div>
</body>
</html>
